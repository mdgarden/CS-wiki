---
tags:
  - Functional_Programming
  - JavaScript
  - Grokking
  - Taming
  - Complex
  - Software
  - with
  - Thinking
---

## 내용
- 현실적인 문제에 함수형 사고를 적용해보기
- 소프트웨어 구조를 잡는 데 계층형 설계가 좋은 이유를 설명
- 액션을 타임라인으로 시각화해보기
- 타임라인을 사용하면 시간에 관한 문제를 잘 풀 수 있다는 것을 배움
#계층형_설계 #타임라인_다이어그램 #일급_함수


## 파트 I : 액션과 계산, 데이터
### 액션
액션은 호출 횟수와 시점에 의존하는 것. 오븐이나 배달차 같은 자원과 요리 재료를 사용하는 것. 액션은 사용할 때 조심해야 함.

`예) 반죽 펴기, 피자 배달, 재료 주문`

### 계산
어떤 것을 결정하거나 계획하는 것은 계산. ==계산은 실행해도 다른 곳에 영향을 주지 않음.== 계산은 아무 때나 사용해도 다른 코드에 영향이 가지 않음.

`예) 조리법에 나온 것을 두 배로 만들기, 쇼핑 목록 결정`

### 데이터
결제, 재고, 피자 조리법 같은 것. 데이터는 유연하기 때문에 저장하거나 네트워크로 전송하는 등 다양하게 쓸 수 있음

`예) 고객 주문, 영수증, 조리법`

## 변경 가능성에 따라 코드 나누기
### 계층화 설계 맛보기

- 변경 가능성에 따라 코드를 나누기
	- 위쪽으로 갈수록 자주 바뀌는 코드
	- 아래쪽으로 갈수록 자주 바뀌지 않는 코드


|             | 피자 주방 레이어                       | 창고 레이어                          | 메인 레이어                                         |
| ----------- | ------------------------------- | ------------------------------- | ---------------------------------------------- |
| 자주 바뀌는 것    | 이번 주 메뉴<br>- 이번 주 특별 메뉴를 위한 조리법 | 이번 주 사야할 것<br>- 재료를 어디서 구입할지 결정 | 비즈니스 규칙                                        |
| ↕️          | 피자 만들기<br>- 조리법 순서              | 재료 목록<br>- 재료 목록에 대한 동작         | 도메인 규칙                                         |
| 자주 바뀌지 않는 것 | 자바스크립트<br>- 객체<br>- 배열          | 자바스크립트<br>- 객체<br>- 숫자          | 기술 스택<br>(계층화 설계가 비즈니스, 도메인 및 기술 문제를 명확하게 분리함) |


- 각 계층은 그 아래에 있는 계층을 기반으로 만들어짐
	- 가장 위에 있는 코드는 의존성이 거의 없기 때문에 쉽게 바꿀 수 있음
	- 아래에 있는 코드들은 위에 있는 코드보다 의존성이 많아 바꾸기 어렵지만 자주 바뀌지 않습니다.
- 이 아키텍처 패턴이 계층을 만들기 때문에 ==계층형 설계(stratified design)== 이라고 부름
	- 계층형 설계는 일반적으로 비즈니스 규칙, 도메인 규칙, 기술 스택 계층으로 나눔
	- 계층형 설계로 만든 코드는 테스트, 재사용, 유지보수가 쉬움

## 파트 II: 일급 추상
### 주방을 자동화하기
- 타임라인 다이어그램 예시

| 치즈 피자 만들기 |
| --------- |
| 주문 접수     |
| 반죽 만들기    |
| 반죽 펴기     |
| 소스 만들기    |
| 소스 뿌리기    |
| 치즈 갈기     |
| 치즈 뿌리기    |
| 오븐에 넣기    |
| 10분 기다리기  |
| 서빙        |
| 피자 완성     |
- 타임라인에 있는 모든 단계는 액션임
- 각 단계에서 다음 단계에 할 일을 볼 수 있음

## 분산 시스템을 타임라인으로 시각화하기
- 각자의 타임라인으로 동시에 일하는 것
- 분산 시스템에서 독립된 액션의 실행 순서는 어떻게 될지 모름
	- 각각의 타임라인에서 처리되는 일은 순서가 섞여 누가 먼저 끝날지 알 수 없음


## 각각의 타임라인은 다른 순서로 실행됩니다

- 기본적으로 타임라인은 서로 순서를 맞출 수 있는 기능이 없음
- 다른 타임라인 작업이 끝날 때까지 기다리라른 표시가 없어서 순서대로 다음 단계를 그냥 진행함
- ==타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행됨==

### 타임라인 커팅: 로봇이 서로를 기다릴 수 있게 하기
- 타임라인 #커팅 은 여러 타임라인이 동시에 진행될 때 서로 순서를 맞추는 방법
	- 타임라인 커팅은 #고차_동작 (high-order operation)으로 구현


## 요점 정리
- 액션과 계산, 데이터를 구분하는 일은 함수형 프로그래머에게 가장 중요하고 첫 번째로 해야 하는 일임
- 함수형 프로그래머는 유지보수를 잘하기 위해 계층형 설계를 사용함.
	- 각 계층은 코드의 변경 가능성에 따라 나눔
- 타임라인 다이어그램은 시간에 따라 변하는 액션을 시각화하는 방법
	- 타임라인 다이어그램으로 액션이 다른 액션과 어떻게 연결되는지 볼 수 있음
	- 타임라인 다이어그램을 그리는 방법은 [[15. 타임라인 격리하기]]에서 배움
- 액션 간 협력을 위해 타임라인 커팅이라는 기술을 살펴보았음.
	- 타임라인 커팅은 액션이 올바른 순서로 실행할 수 있도록 보장해줌
	- [[17. 타임라인 조율하기]]에서 타임라인 커팅에 대해 바움